{"ast":null,"code":"var _jsxFileName = \"E:\\\\LIBRARY\\\\software_project\\\\website-demo\\\\src\\\\PostPage.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport CommentSideBar from \"./components/CommentSideBar\";\nimport Intro from \"./components/Intro\";\nimport CommentPost from \"./components/CommentPost\";\n\n//todo 需要根据Post点击后 后台传过来的内容来确定Header内容\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PostPage(props) {\n  _s();\n  const [comments, setComments] = useState([]);\n  useEffect(() => {\n    setTimeout(() => {\n      console.log(\"Aloha!\");\n      fetchComments();\n      console.log(1);\n    }, 0);\n  }, []);\n\n  // function\n\n  // id={cmt.id} tmp_name={cmt.tmp_name} avatar={cmt.avatar} cmt={cmt} comment_under={cmt.comment_under} reply_to={cmt.reply_to} likes={cmt.likes}  time={cmt.comment_time} content={cmt.comment_content}\n  // <CommentPost name={comment.tmp_name} likes={comment.likes-comment.hates} time={comment.comment_time} content={comment.comment_content}></CommentPost>\n  const commentList = comments.map(comment => /*#__PURE__*/_jsxDEV(CommentPost, {\n    name: comment.tmp_name,\n    likes: comment.likes - comment.hates,\n    time: comment.comment_time,\n    content: comment.comment_content,\n    avatar: comment.avatar,\n    id: comment.id,\n    token: props.token\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 22,\n    columnNumber: 48\n  }, this));\n  function addComment(comment) {\n    setComments([...comments, comment]);\n  }\n  useEffect(() => {\n    setTimeout(() => {\n      console.log(\"go deeper!\");\n      console.log(props.post_id);\n      fetchComments();\n      console.log(\"!!\");\n    }, 0);\n  }, []);\n  function fetchComments() {\n    fetch(\"/post/\" + props.post_id + \"/\", {\n      method: \"GET\"\n    }).then(response => {\n      console.log(\"response\");\n      console.log(response);\n      return response.json();\n    }).then(data => {\n      console.log(\"data\");\n      console.log(data);\n      setComments(data.post_comment);\n      console.log(\"comments\");\n      console.log(comments);\n      // console.log(commentList)\n    });\n  }\n\n  function handleReply(pk) {\n    fetch(\"/post/comment/\" + pk + \"/\", {\n      method: \"POST\",\n      mode: \"cors\",\n      cache: \"no-cache\",\n      credentials: \"same-origin\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Token \" + props.token\n      },\n      redirect: \"follow\",\n      referrerPolicy: \"no-referrer\",\n      body: JSON.stringify({\n        comment_under: props.post_id,\n        comment_content: \"sdfsdf\"\n      })\n    }).then(response => {\n      console.log(response);\n      return response.json();\n    }).then(data => {\n      console.log(data);\n    });\n  }\n  function handleCollect(pk) {\n    fetch('/post/' + pk + '/collect/', {\n      method: \"PUT\",\n      mode: \"cors\",\n      cache: \"no-cache\",\n      credentials: \"same-origin\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Token \" + props.token\n      },\n      redirect: \"follow\",\n      referrerPolicy: \"no-referrer\",\n      body: JSON.stringify({\n        stars: 0\n      })\n    }).then(response => {\n      console.log(pk);\n      console.log(response);\n      return response.json();\n    }).then(data => {\n      console.log(data);\n    });\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"PostPageContent\",\n    children: [/*#__PURE__*/_jsxDEV(Intro, {\n      mainTitle: props.name,\n      subTitle: props.tag\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid d-flex flex-row-reverse flex-wrap\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-3 d-flex flex-column align-items-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CommentSideBar, {\n          onReply: handleReply,\n          onCollect: handleCollect,\n          post_id: props.post_id\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-9 me-auto\",\n        children: commentList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 5\n  }, this);\n}\n_s(PostPage, \"Gb0IamD7JIldgnM2007Mizf1VNM=\");\n_c = PostPage;\nvar _c;\n$RefreshReg$(_c, \"PostPage\");","map":{"version":3,"names":["useEffect","useState","CommentSideBar","Intro","CommentPost","PostPage","props","comments","setComments","setTimeout","console","log","fetchComments","commentList","map","comment","tmp_name","likes","hates","comment_time","comment_content","avatar","id","token","addComment","post_id","fetch","method","then","response","json","data","post_comment","handleReply","pk","mode","cache","credentials","headers","Authorization","redirect","referrerPolicy","body","JSON","stringify","comment_under","handleCollect","stars","name","tag"],"sources":["E:/LIBRARY/software_project/website-demo/src/PostPage.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport CommentSideBar from \"./components/CommentSideBar\";\r\nimport Intro from \"./components/Intro\";\r\nimport CommentPost from \"./components/CommentPost\";\r\n\r\n//todo 需要根据Post点击后 后台传过来的内容来确定Header内容\r\nexport default function PostPage(props) {\r\n  const [comments, setComments] = useState([]);\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      console.log(\"Aloha!\");\r\n      fetchComments();\r\n      console.log(1);\r\n    }, 0);\r\n  }, []);\r\n\r\n  // function\r\n\r\n  // id={cmt.id} tmp_name={cmt.tmp_name} avatar={cmt.avatar} cmt={cmt} comment_under={cmt.comment_under} reply_to={cmt.reply_to} likes={cmt.likes}  time={cmt.comment_time} content={cmt.comment_content}\r\n  // <CommentPost name={comment.tmp_name} likes={comment.likes-comment.hates} time={comment.comment_time} content={comment.comment_content}></CommentPost>\r\n  const commentList = comments.map((comment)=>(<CommentPost name={comment.tmp_name} likes={comment.likes-comment.hates} time={comment.comment_time} content={comment.comment_content} avatar={comment.avatar} id={comment.id} token={props.token}></CommentPost>))\r\n\r\n\r\n\r\n  function addComment(comment) {\r\n    setComments([...comments, comment]);\r\n  }\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      console.log(\"go deeper!\");\r\n      console.log(props.post_id);\r\n      fetchComments();\r\n      console.log(\"!!\");\r\n    }, 0);\r\n  }, []);\r\n\r\n  function fetchComments() {\r\n    fetch(\"/post/\" + props.post_id + \"/\", {\r\n      method: \"GET\",\r\n    })\r\n      .then((response) => {\r\n        console.log(\"response\");\r\n        console.log(response);\r\n        return response.json();\r\n      })\r\n      .then((data) => {\r\n        console.log(\"data\");\r\n        console.log(data);\r\n        setComments(data.post_comment);\r\n        console.log(\"comments\");\r\n        console.log(comments);\r\n        // console.log(commentList)\r\n      });\r\n  }\r\n\r\n  function handleReply(pk) {\r\n    fetch(\"/post/comment/\" + pk + \"/\", {\r\n      method: \"POST\",\r\n      mode: \"cors\",\r\n      cache: \"no-cache\",\r\n      credentials: \"same-origin\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: \"Token \" + props.token,\r\n      },\r\n      redirect: \"follow\",\r\n      referrerPolicy: \"no-referrer\",\r\n      body: JSON.stringify({\r\n        comment_under: props.post_id,\r\n        comment_content: \"sdfsdf\",\r\n      }),\r\n    })\r\n      .then((response) => {\r\n        console.log(response);\r\n        return response.json();\r\n      })\r\n      .then((data) => {\r\n        console.log(data);\r\n      });\r\n  }\r\n\r\n  function handleCollect(pk) {\r\n    fetch('/post/'+pk+'/collect/', {\r\n      method: \"PUT\",\r\n      mode: \"cors\",\r\n      cache: \"no-cache\",\r\n      credentials: \"same-origin\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: \"Token \" + props.token,\r\n      },\r\n      redirect: \"follow\",\r\n      referrerPolicy: \"no-referrer\",\r\n      body: JSON.stringify({\r\n        stars: 0,\r\n      }),\r\n    }).then((response) => {\r\n      console.log(pk);\r\n      console.log(response);\r\n      return response.json()\r\n    }).then((data)=>{\r\n      console.log(data)\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div className=\"PostPageContent\">\r\n      <Intro mainTitle={props.name} subTitle={props.tag} ></Intro>\r\n      <div className=\"container-fluid d-flex flex-row-reverse flex-wrap\">\r\n        <div className=\"col-md-3 d-flex flex-column align-items-center\">\r\n          <br></br>\r\n          <CommentSideBar\r\n            onReply={handleReply}\r\n            onCollect={handleCollect}\r\n            post_id={props.post_id}\r\n          ></CommentSideBar>\r\n        </div>\r\n\r\n        <div className=\"col-md-9 me-auto\">{commentList}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}